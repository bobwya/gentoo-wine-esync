--- a/0002-server-Create-server-objects-for-eventfd-based-synch.patch	2018-11-01 17:19:43.000000000 +0000
+++ b/0002-server-Create-server-objects-for-eventfd-based-synch.patch	2020-04-23 17:16:55.425222782 +0100
@@ -65,7 +65,7 @@
 +    struct create_esync_reply create_esync_reply;
  };
  
- #define SERVER_PROTOCOL_VERSION 570
+ 
 diff --git a/server/Makefile.in b/server/Makefile.in
 index aaaa8d34d5..5d96d22774 100644
 --- a/server/Makefile.in
@@ -83,7 +83,7 @@
 index 0000000000..66cae244f6
 --- /dev/null
 +++ b/server/esync.c
-@@ -0,0 +1,136 @@
+@@ -0,0 +1,137 @@
 +/*
 + * eventfd-based synchronization objects
 + *
@@ -149,6 +149,7 @@
 +    directory_link_name,       /* link_name */
 +    default_unlink_name,       /* unlink_name */
 +    no_open_file,              /* open_file */
++    no_alloc_handle,           /* alloc_handle */
 +    no_close_handle,           /* close_handle */
 +    esync_destroy              /* destroy */
 +};
@@ -224,7 +225,7 @@
 index 6e02fbc501..b743674ebd 100644
 --- a/server/protocol.def
 +++ b/server/protocol.def
-@@ -3855,3 +3855,13 @@ struct handle_info
+@@ -3968,6 +3968,16 @@ struct handle_info
      obj_handle_t handle;          /* handle to the job */
      int          status;          /* process exit code */
  @END
@@ -238,6 +239,9 @@
 +@REPLY
 +    obj_handle_t handle;        /* handle to the object */
 +@END
+ 
+ 
+ /* Return system information values */
 diff --git a/server/request.h b/server/request.h
 index 4610ca6868..242143d2c3 100644
 --- a/server/request.h
