--- a/0015-server-Create-eventfd-file-descriptors-for-process-o.patch	2018-11-01 17:19:43.000000000 +0000
+++ b/0015-server-Create-eventfd-file-descriptors-for-process-o.patch	2020-04-12 23:48:33.993256970 +0100
@@ -3,7 +3,6 @@
 Date: Fri, 8 Jun 2018 18:57:12 -0500
 Subject: [PATCH 15/83] server: Create eventfd file descriptors for process
  objects.
-
 Signed-off-by: Zebediah Figura <z.figura12@gmail.com>
 ---
  server/esync.c   | 33 +++++++++++++++++++++++++++++++++
@@ -12,7 +11,6 @@
  server/process.h |  1 +
  4 files changed, 72 insertions(+), 1 deletion(-)
  create mode 100644 server/esync.h
-
 diff --git a/server/esync.c b/server/esync.c
 index e775b3bd28..f50366a434 100644
 --- a/server/esync.c
@@ -105,7 +103,7 @@
  /* process structure */
  
 @@ -64,6 +65,7 @@ static int process_signaled( struct object *obj, struct wait_queue_entry *entry
- static unsigned int process_map_access( struct object *obj, unsigned int access );
+ static struct security_descriptor *process_get_sd( struct object *obj );
  static void process_poll_event( struct fd *fd, int event );
  static void process_destroy( struct object *obj );
 +static int process_get_esync_fd( struct object *obj );
@@ -130,8 +128,8 @@
      list_init( &process->locks );
      list_init( &process->asyncs );
 @@ -574,6 +577,9 @@ struct process *create_process( int fd, struct process *parent, int inherit_all,
-     if (!token_assign_label( process->token, security_high_label_sid ))
-         goto error;
+     }
+     if (!process->handles || !process->token) goto error;
  
 +    if (do_esync())
 +        process->esync_fd = esync_create_fd( 0, 0 );
@@ -176,4 +174,3 @@
  struct process_snapshot
 -- 
 2.19.1
-
