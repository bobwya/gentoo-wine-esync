--- a/0015-server-Create-eventfd-file-descriptors-for-process-o.patch	2018-11-01 17:19:43.000000000 +0000
+++ b/0015-server-Create-eventfd-file-descriptors-for-process-o.patch	2020-04-29 20:41:37.221343571 +0100
@@ -105,7 +105,7 @@
  /* process structure */
  
 @@ -64,6 +65,7 @@ static int process_signaled( struct object *obj, struct wait_queue_entry *entry
- static unsigned int process_map_access( struct object *obj, unsigned int access );
+ static struct security_descriptor *process_get_sd( struct object *obj );
  static void process_poll_event( struct fd *fd, int event );
  static void process_destroy( struct object *obj );
 +static int process_get_esync_fd( struct object *obj );
@@ -130,8 +130,8 @@
      list_init( &process->locks );
      list_init( &process->asyncs );
 @@ -574,6 +577,9 @@ struct process *create_process( int fd, struct process *parent, int inherit_all,
-     if (!token_assign_label( process->token, security_high_label_sid ))
-         goto error;
+     }
+     if (!process->handles || !process->token) goto error;
  
 +    if (do_esync())
 +        process->esync_fd = esync_create_fd( 0, 0 );
