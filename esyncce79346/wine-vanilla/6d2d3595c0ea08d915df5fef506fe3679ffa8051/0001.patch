--- a/0001-configure-Check-for-sys-eventfd.h-ppoll-and-shm_open.patch	2018-11-01 17:19:42.000000000 +0000
+++ b/0001-configure-Check-for-sys-eventfd.h-ppoll-and-shm_open.patch	2020-04-12 23:48:27.586570054 +0100
@@ -3,42 +3,38 @@
 Date: Wed, 13 Jun 2018 10:44:49 -0500
 Subject: [PATCH 01/83] configure: Check for sys/eventfd.h, ppoll(), and
  shm_open().
-
 We use ppoll() instead of poll() for the better time granularity.
-
 Although perhaps we shouldn't since the server doesn't do this.
-
 Signed-off-by: Zebediah Figura <z.figura12@gmail.com>
 ---
  configure           | 68 +++++++++++++++++++++++++++++++++++++++++++++
  configure.ac        | 12 ++++++++
  include/config.h.in |  9 ++++++
  3 files changed, 89 insertions(+)
-
 diff --git a/configure b/configure
 index 51e3d7fc14..eb0a11ca86 100755
 --- a/configure
 +++ b/configure
 @@ -7352,6 +7352,7 @@ for ac_header in \
- 	sys/elf32.h \
+ 	sys/cdio.h \
  	sys/epoll.h \
  	sys/event.h \
 +	sys/eventfd.h \
- 	sys/exec_elf.h \
  	sys/filio.h \
- 	sys/inotify.h \
+ 	sys/ioctl.h \
+ 	sys/ipc.h \
 @@ -16552,6 +16553,7 @@ for ac_func in \
+ 	pipe2 \
  	poll \
- 	popen \
  	port_create \
 +	ppoll \
  	prctl \
  	pread \
  	proc_pidinfo \
-@@ -16964,6 +16966,72 @@ fi
- 
- LIBS=$ac_save_LIBS
+@@ -17688,6 +17690,72 @@ fi
+ fi
  
+     LIBS=$ac_save_LIBS
 +if test "$ac_cv_header_sys_mman_h" = "yes" -a "x$RT_LIBS" = "x"
 +then
 +    ac_save_LIBS=$LIBS
@@ -105,33 +101,33 @@
 +fi
 +LIBS=$ac_save_LIBS
 +
- if test "x$with_ldap" != "xno"
- then
-         if ${LDAP_CFLAGS:+false} :; then :
+     ;;
+ esac
+ 
 diff --git a/configure.ac b/configure.ac
 index b64d99e9d1..fae1a1a228 100644
 --- a/configure.ac
 +++ b/configure.ac
 @@ -513,6 +513,7 @@ AC_CHECK_HEADERS(\
- 	sys/elf32.h \
+ 	sys/cdio.h \
  	sys/epoll.h \
  	sys/event.h \
 +	sys/eventfd.h \
- 	sys/exec_elf.h \
  	sys/filio.h \
- 	sys/inotify.h \
+ 	sys/ioctl.h \
+ 	sys/ipc.h \
 @@ -2176,6 +2177,7 @@ AC_CHECK_FUNCS(\
+ 	pipe2 \
  	poll \
- 	popen \
  	port_create \
 +	ppoll \
  	prctl \
  	pread \
  	proc_pidinfo \
-@@ -2256,6 +2258,16 @@ AC_SEARCH_LIBS(clock_gettime, rt,
+@@ -2169,6 +2171,16 @@ AC_SEARCH_LIBS(clock_gettime, rt,
+             [AC_DEFINE(HAVE_CLOCK_GETTIME, 1, [Define to 1 if you have the `clock_gettime' function.])
                  test "$ac_res" = "none required" || AC_SUBST(RT_LIBS,"$ac_res")])
- LIBS=$ac_save_LIBS
- 
+     LIBS=$ac_save_LIBS
 +dnl Check for shm_open which may be in -lrt
 +if test "$ac_cv_header_sys_mman_h" = "yes" -a "x$RT_LIBS" = "x"
 +then
@@ -142,16 +138,16 @@
 +fi
 +LIBS=$ac_save_LIBS
 +
- dnl **** Check for OpenLDAP ***
- if test "x$with_ldap" != "xno"
- then
+     ;;
+ esac
+ 
 diff --git a/include/config.h.in b/include/config.h.in
 index c5a3cb4807..1ba9efb29e 100644
 --- a/include/config.h.in
 +++ b/include/config.h.in
 @@ -750,6 +750,9 @@
- /* Define if we can use ppdev.h for parallel port access */
- #undef HAVE_PPDEV
+ /* Define to 1 if you have the <port.h> header file. */
+ #undef HAVE_PORT_H
  
 +/* Define to 1 if you have the `ppoll' function. */
 +#undef HAVE_PPOLL
@@ -181,4 +177,3 @@
  
 -- 
 2.19.1
-
